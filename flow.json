[{"id":"91f789ec.a4f17","type":"tab","label":"Playground, tests","disabled":false,"info":""},{"id":"f7a0cac1.5f5af","type":"tab","label":"MQTT","disabled":false,"info":""},{"id":"98b0effc.65096","type":"tab","label":"Sensors","disabled":false,"info":""},{"id":"f898b011.8cb44","type":"tab","label":"LCD","disabled":false,"info":""},{"id":"c16ac57b.fa21f","type":"tab","label":"Camera","disabled":false,"info":""},{"id":"42ca863f.50d128","type":"mqtt-broker","z":"","name":"QNAP","broker":"10.0.10.30","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthRetain":"false","birthPayload":"","closeTopic":"","closeQos":"0","closeRetain":"false","closePayload":"","willTopic":"","willQos":"0","willRetain":"false","willPayload":""},{"id":"958db5d8.45c0b8","type":"tls-config","z":"","name":"plant_thing","cert":"","key":"","ca":"","certname":"01d6fa5abe-certificate.pem.crt","keyname":"01d6fa5abe-private.pem.key","caname":"aws_root_CA.pem","servername":"","verifyservercert":true},{"id":"8251bee0.c70e98","type":"aws-config-s3","z":0},{"id":"e9d622c9.8920d8","type":"ina-sensor-manager","z":"","address":"0x40","delay":"15000","ohms":"0.01","customResistor":false},{"id":"1ac48f17.a5a1a1","type":"oled-config","z":"","name":"OLED","width":"128","height":"64","address":"0x3c"},{"id":"fd70a59a.423ef8","type":"mqtt-broker","z":"","name":"AWS","broker":"azajijbaqf61a-ats.iot.eu-central-1.amazonaws.com","port":"8883","tls":"958db5d8.45c0b8","clientid":"","usetls":true,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthRetain":"false","birthPayload":"","closeTopic":"","closeQos":"0","closeRetain":"false","closePayload":"","willTopic":"","willQos":"0","willRetain":"false","willPayload":""},{"id":"df4c01ed.fb6238","type":"Bme280","z":"98b0effc.65096","name":"BME280","bus":"1","address":"0x76","topic":"bme280","extra":false,"x":280,"y":200,"wires":[["89a1f0fb.062d28","20a9c6bd.64feb2","69872bb9.1fa6bc","2eb5ceea.1a8862","5eff1989.7d6308"]]},{"id":"2483a999.6ff35e","type":"inject","z":"98b0effc.65096","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"60","crontab":"","once":true,"onceDelay":"1","x":110,"y":200,"wires":[["df4c01ed.fb6238","76bc5368.817a14"]]},{"id":"89a1f0fb.062d28","type":"function","z":"98b0effc.65096","name":"temperature","func":"newMsg = {};\nnewMsg.payload = msg.payload.temperature_C;\nreturn newMsg;\n\n","outputs":1,"noerr":0,"x":530,"y":160,"wires":[["b748c139.806df"]]},{"id":"20a9c6bd.64feb2","type":"function","z":"98b0effc.65096","name":"humidity","func":"newMsg = {};\n// newMsg.payload = msg.payload.humidity;\nnewMsg.payload = JSON.parse(Number(msg.payload.humidity).toFixed(2));\nreturn newMsg;","outputs":1,"noerr":0,"x":520,"y":200,"wires":[["19d61a28.ce817e"]]},{"id":"69872bb9.1fa6bc","type":"function","z":"98b0effc.65096","name":"pressure","func":"newMsg = {};\nnewMsg.payload = JSON.parse(Number(msg.payload.pressure_hPa).toFixed(2));\n// newMsg.payload = msg.payload.pressure_hPa;\nreturn newMsg;","outputs":1,"noerr":0,"x":520,"y":240,"wires":[["45183fd9.456ce8"]]},{"id":"8204dda.5c169a","type":"function","z":"f898b011.8cb44","name":"combine received msgs into one","func":"context.data = context.data || {};\n\nswitch (msg.topic) {\n    case \"bme280\":\n        context.data.temperature = msg.payload.temperature_C;\n        context.data.humidity = msg.payload.humidity;\n        context.data.preassure = msg.payload.pressure_hPa;\n        msg = null;\n        break;\n        \n    case \"up\":\n        context.data.uptime = msg.payload;\n        msg = null;\n        break;\n}\n\nif (context.data.temperature != null &&\n    context.data.humidity != null &&\n    context.data.preassure != null &&\n    context.data.uptime != null) {\n        newMsg = {};\n        var temp = Number(context.data.temperature).toFixed(2);\n        var humi = Number(context.data.humidity).toFixed(2);\n        var press = Number(context.data.preassure).toFixed(1);\n\n        newMsg.payload =\n        [{\n            \"clear\": true,\n            \"text\": \"temp \"+ temp,\n            \"aligment\": \"left\"\n            },\n            {\n            \"clear\": true,\n            \"text\": \"hum  \"+ humi,\n            \"aligment\": \"left\"\n            },\n            {\n            \"clear\": true,\n             \"text\": \"pres \"+ press,\n             \"aligment\": \"left\"\n            },\n            {\n            \"clear\": true,\n            \"text\": \"up  \"+ context.data.uptime,\n            \"aligment\": \"left\"\n            }\n        ]\n        return newMsg;\n}\n\n","outputs":1,"noerr":0,"x":510,"y":740,"wires":[[]]},{"id":"6ab4dbc2.100f9c","type":"link in","z":"f898b011.8cb44","name":"to-display-on-LCD","links":["aa4365c9.761a18","dd12e0ac.f6805","9041c4e9.f53fe8"],"x":315,"y":740,"wires":[["8204dda.5c169a"]]},{"id":"aa4365c9.761a18","type":"link out","z":"98b0effc.65096","name":"bme280-readings","links":["6ab4dbc2.100f9c"],"x":675,"y":120,"wires":[]},{"id":"2eb5ceea.1a8862","type":"function","z":"98b0effc.65096","name":"topic bme280","func":"msg.topic=\"bme280\";\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":120,"wires":[["aa4365c9.761a18"]]},{"id":"db0c6d5d.5f565","type":"comment","z":"91f789ec.a4f17","name":"TODO list","info":"","x":120,"y":60,"wires":[]},{"id":"e81b166a.f93e98","type":"mqtt in","z":"f7a0cac1.5f5af","name":"","topic":"garden/weather/sensor/temperature","qos":"2","datatype":"auto","broker":"42ca863f.50d128","x":160,"y":100,"wires":[["23897e93.734fca"]]},{"id":"b0f5c114.a4bbc8","type":"mqtt in","z":"f7a0cac1.5f5af","name":"","topic":"garden/weather/sensor/humidity","qos":"2","datatype":"auto","broker":"42ca863f.50d128","x":150,"y":160,"wires":[["89e927b1.bfb0e8"]]},{"id":"76bc5368.817a14","type":"pythonshell in","z":"98b0effc.65096","name":"read lx","pyfile":"/home/pi/.node-red/projects/plant-monitor/read_tls2561.py","virtualenv":"","continuous":false,"stdInData":false,"x":290,"y":380,"wires":[["7a858685.7a072"]]},{"id":"7a858685.7a072","type":"yaml","z":"98b0effc.65096","property":"payload","name":"\"","x":430,"y":380,"wires":[["a35d5973.426f78","9d681f3d.eb09c8"]]},{"id":"cff98706.3b94","type":"switch","z":"98b0effc.65096","name":"","property":"topic","propertyType":"msg","rules":[{"t":"cont","v":"Full","vt":"str"},{"t":"cont","v":"IR","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":710,"y":380,"wires":[["15e5d78c.d20e68"],["e5e4c2e4.056f38"]]},{"id":"a35d5973.426f78","type":"split","z":"98b0effc.65096","name":"","splt":",","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"topic","x":570,"y":380,"wires":[["cff98706.3b94"]]},{"id":"df1bb79d.d72ab8","type":"change","z":"98b0effc.65096","name":"Extract value","rules":[{"t":"set","p":"payload","pt":"msg","to":"*.*","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":290,"y":480,"wires":[["151b417c.e58407"]]},{"id":"6465c5dc.369c24","type":"camerapi-takephoto","z":"c16ac57b.fa21f","filemode":"1","filename":"{{msg.payload.filename}}","filedefpath":"0","filepath":"/home/pi/pictures/","fileformat":"jpeg","resolution":"1","rotation":"0","fliph":"0","flipv":"0","brightness":"50","contrast":"0","sharpness":"0","quality":"80","imageeffect":"none","exposuremode":"auto","iso":"0","agcwait":"1.0","led":"1","awb":"auto","name":"take photo","x":670,"y":100,"wires":[["2ee72ba5.62ce54"]]},{"id":"151b417c.e58407","type":"function","z":"98b0effc.65096","name":"reformat","func":"msg.payload = JSON.parse(Number(msg.payload).toFixed(2));\nreturn msg;","outputs":1,"noerr":0,"x":460,"y":480,"wires":[["e0c9188b.3e106"]]},{"id":"dab8342d.e3b3a8","type":"comment","z":"f7a0cac1.5f5af","name":"External sensors values","info":"","x":180,"y":40,"wires":[]},{"id":"5068057d.fed9ec","type":"comment","z":"f898b011.8cb44","name":"","info":"","x":120,"y":60,"wires":[]},{"id":"d2639062.f8449","type":"function","z":"c16ac57b.fa21f","name":"format image name string","func":"var date;\ndate = new Date();\ndate = (date.getFullYear() + '-' + ('00' + (date.getMonth()+1)).slice(-2) + '-' + ('00' + date.getDate()).slice(-2) + 'T' + ('00' + date.getHours()).slice(-2) + ':' + ('00' + date.getMinutes()).slice(-2) + ':' + ('00' + date.getSeconds()).slice(-2));\n\nmsg.filename = \"plant_picture_\" + date + \".jpg\";\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":100,"wires":[["6465c5dc.369c24"]]},{"id":"6230aa.bfd8ff58","type":"inject","z":"f7a0cac1.5f5af","name":"start default values","topic":"","payload":"{\"deviceID\":\"plant\",\"interval\":15,\"temperature\":20,\"humidity\":20,\"preassure\":1000,\"temperature_outdoor\":20,\"humidity_outdoor\":20,\"light_full\":0,\"light_ir\":0,\"moisture\":1,\"voltage\":0,\"current\":0,\"load\":0,\"uptime\":0}","payloadType":"json","repeat":"900","crontab":"","once":true,"onceDelay":"5","x":140,"y":540,"wires":[["c118aa8c.c0b278","edaaba0a.0f615"]]},{"id":"c118aa8c.c0b278","type":"function","z":"f7a0cac1.5f5af","name":"gather all global vars info to one msg","func":"msg.payload.deviceID+=\"01\"\nmsg.payload.temperature = global.get(\"temperature\");\nmsg.payload.temperature_outdoor = global.get(\"temperatureOutdoor\");\nmsg.payload.humidity = global.get(\"humidity\");\nmsg.payload.humidity_outdoor = global.get(\"humidityOutdoor\");\nmsg.payload.pressure = global.get(\"pressure\");\nmsg.payload.light_full = global.get(\"light_full\");\nmsg.payload.light_ir = global.get(\"light_ir\");\nmsg.payload.moisture = global.get(\"moisture\");\nmsg.payload.voltage = global.get(\"voltage\");\nmsg.payload.current = global.get(\"current\");\nmsg.payload.load = global.get(\"load\");\nmsg.payload.uptime = global.get(\"uptime\");\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":540,"wires":[["5afaa662.def1f","f8c30f07.46c47"]]},{"id":"b748c139.806df","type":"change","z":"98b0effc.65096","name":"","rules":[{"t":"set","p":"temperature","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":760,"y":160,"wires":[[]]},{"id":"19d61a28.ce817e","type":"change","z":"98b0effc.65096","name":"","rules":[{"t":"set","p":"humidity","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":750,"y":200,"wires":[[]]},{"id":"45183fd9.456ce8","type":"change","z":"98b0effc.65096","name":"","rules":[{"t":"set","p":"pressure","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":750,"y":240,"wires":[[]]},{"id":"d4e772de.ce8fe8","type":"change","z":"f7a0cac1.5f5af","name":"","rules":[{"t":"set","p":"temperatureOutdoor","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":670,"y":100,"wires":[["d06b603e.dcb508"]]},{"id":"8695e00.d675f2","type":"change","z":"f7a0cac1.5f5af","name":"","rules":[{"t":"set","p":"humidityOutdoor","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":160,"wires":[["2f00bdca.c7bb6a"]]},{"id":"15e5d78c.d20e68","type":"change","z":"98b0effc.65096","name":"","rules":[{"t":"set","p":"light_full","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":910,"y":360,"wires":[[]]},{"id":"e5e4c2e4.056f38","type":"change","z":"98b0effc.65096","name":"","rules":[{"t":"set","p":"light_ir","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":910,"y":400,"wires":[[]]},{"id":"e0c9188b.3e106","type":"change","z":"98b0effc.65096","name":"","rules":[{"t":"set","p":"moisture","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":730,"y":480,"wires":[[]]},{"id":"af8294ce.0fffa8","type":"function","z":"f898b011.8cb44","name":"format for LCD","func":"        newMsg = {};\n        var temp = Number(global.temperature).toFixed(2);\n        var humi = Number(global.humidity).toFixed(2);\n        var press = Number(global.preassure).toFixed(1);\n\n        newMsg.payload =\n        [{\n            \"clear\": true,\n            \"text\": \"temp \"+ temp,\n            \"aligment\": \"left\"\n            },\n            {\n            \"clear\": true,\n            \"text\": \"hum  \"+ humi,\n            \"aligment\": \"left\"\n            },\n            {\n            \"clear\": true,\n             \"text\": \"pres \"+ press,\n             \"aligment\": \"left\"\n            },\n            {\n            \"clear\": true,\n            \"text\": \"up  \"+ context.data.uptime,\n            \"aligment\": \"left\"\n            }\n        ]\n        return newMsg;","outputs":1,"noerr":0,"x":560,"y":800,"wires":[[]]},{"id":"5afaa662.def1f","type":"debug","z":"f7a0cac1.5f5af","name":"aws","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":790,"y":480,"wires":[]},{"id":"d06b603e.dcb508","type":"debug","z":"f7a0cac1.5f5af","name":"temp outdoor","active":false,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":920,"y":100,"wires":[]},{"id":"23897e93.734fca","type":"yaml","z":"f7a0cac1.5f5af","property":"payload","name":"","x":390,"y":100,"wires":[["d4e772de.ce8fe8"]]},{"id":"89e927b1.bfb0e8","type":"yaml","z":"f7a0cac1.5f5af","property":"payload","name":"","x":390,"y":160,"wires":[["8695e00.d675f2"]]},{"id":"ab6d3327.3e6a38","type":"function","z":"c16ac57b.fa21f","name":"file path","func":"msg.localFilename=\"/home/pi/pictures/plant_picture_2020-04-23T21:09:27.jpg\";\nmsg.filename=\"test2.jpg\";\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":200,"wires":[["307355c7.fe05a2"]]},{"id":"2ee72ba5.62ce54","type":"debug","z":"c16ac57b.fa21f","name":"camera","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":840,"y":100,"wires":[]},{"id":"4946a2cd.e8846c","type":"inject","z":"c16ac57b.fa21f","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":240,"y":100,"wires":[["d2639062.f8449"]]},{"id":"399ca5bf.3a2cea","type":"inject","z":"c16ac57b.fa21f","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":250,"y":200,"wires":[["ab6d3327.3e6a38"]]},{"id":"15f2f629.12335a","type":"debug","z":"c16ac57b.fa21f","name":"s3","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":720,"y":200,"wires":[]},{"id":"307355c7.fe05a2","type":"amazon s3 put","z":"c16ac57b.fa21f","aws":"8251bee0.c70e98","bucket":"garden-of-tangled-data","filename":"","localFilename":"","contentType":"image/jpeg","contentEncoding":"","region":"eu-central-1","isBase64":"","name":"s3","acl":"private","outputs":1,"x":550,"y":200,"wires":[["15f2f629.12335a"]]},{"id":"5eff1989.7d6308","type":"debug","z":"98b0effc.65096","name":"bme280","active":false,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":520,"y":40,"wires":[]},{"id":"9d681f3d.eb09c8","type":"debug","z":"98b0effc.65096","name":"LX","active":false,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":570,"y":320,"wires":[]},{"id":"8c9ea1fb.bf00b8","type":"ina-sensor","z":"98b0effc.65096","name":"","handle":"e9d622c9.8920d8","x":290,"y":620,"wires":[["f1548d56.de3a38"],["321b7151.bd2ade"]]},{"id":"b3b34b11.84c0f","type":"debug","z":"98b0effc.65096","name":"Volts","active":false,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":710,"y":580,"wires":[]},{"id":"b73e26ed.e860a","type":"debug","z":"98b0effc.65096","name":"miliAmps","active":false,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":720,"y":660,"wires":[]},{"id":"f1548d56.de3a38","type":"change","z":"98b0effc.65096","name":"","rules":[{"t":"set","p":"voltage","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":580,"wires":[["b3b34b11.84c0f"]]},{"id":"321b7151.bd2ade","type":"change","z":"98b0effc.65096","name":"","rules":[{"t":"set","p":"current","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":660,"wires":[["b73e26ed.e860a"]]},{"id":"2f00bdca.c7bb6a","type":"debug","z":"f7a0cac1.5f5af","name":"humidity outdoor","active":false,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":930,"y":160,"wires":[]},{"id":"6b19a078.08428","type":"rpi-gpio out","z":"f7a0cac1.5f5af","name":"","pin":"16","set":true,"level":"0","freq":"","out":"out","x":580,"y":480,"wires":[]},{"id":"edaaba0a.0f615","type":"trigger","z":"f7a0cac1.5f5af","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"3","extend":false,"units":"s","reset":"","bytopic":"all","name":"","x":400,"y":480,"wires":[["6b19a078.08428"]]},{"id":"397e00f0.aa927","type":"Uptime","z":"f7a0cac1.5f5af","name":"","x":240,"y":300,"wires":[["f6f49810.59b93","f20c7c9e.e55f4"]]},{"id":"64fafde2.157234","type":"inject","z":"f7a0cac1.5f5af","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"60","crontab":"","once":true,"onceDelay":"2","x":90,"y":300,"wires":[["397e00f0.aa927","31cfe369.6cd57c"]]},{"id":"f6f49810.59b93","type":"function","z":"f7a0cac1.5f5af","name":"secs2human","func":"function secondsToString(seconds)\n{\nvar numdays = Math.floor((seconds % 31536000) / 86400); \nvar numhours = Math.floor(((seconds % 31536000) % 86400) / 3600);\nvar numminutes = Math.floor((((seconds % 31536000) % 86400) % 3600) / 60);\nvar numseconds = (((seconds % 31536000) % 86400) % 3600) % 60;\nreturn (numdays + \"d \" + numhours + \"h \" + numminutes + \"m\");\n\n}\nmsg.payload =secondsToString(msg.payload.uptime)\nmsg.topic=\"up\";\nreturn msg","outputs":1,"noerr":0,"x":410,"y":300,"wires":[["2f5c2a88.e939f6"]]},{"id":"9041c4e9.f53fe8","type":"link out","z":"f7a0cac1.5f5af","name":"uptime","links":["6ab4dbc2.100f9c"],"x":855,"y":300,"wires":[]},{"id":"26c0a509.9f8942","type":"change","z":"f7a0cac1.5f5af","name":"","rules":[{"t":"set","p":"uptime","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":240,"wires":[[]]},{"id":"31cfe369.6cd57c","type":"Loadavg","z":"f7a0cac1.5f5af","name":"","x":240,"y":360,"wires":[["894fd562.7d734"]]},{"id":"894fd562.7d734","type":"function","z":"f7a0cac1.5f5af","name":"get 15min","func":"msg.payload = msg.payload.loadavg[2];\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":360,"wires":[["7a20ab87.6333f4"]]},{"id":"7a20ab87.6333f4","type":"change","z":"f7a0cac1.5f5af","name":"","rules":[{"t":"set","p":"load","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":620,"y":360,"wires":[["8c96369f.7f0bb"]]},{"id":"8c96369f.7f0bb","type":"debug","z":"f7a0cac1.5f5af","name":"payload 15min avg","active":false,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":930,"y":360,"wires":[]},{"id":"163d489e.a4a277","type":"rpi-gpio out","z":"f898b011.8cb44","name":"","pin":"12","set":true,"level":"0","freq":"","out":"out","x":960,"y":60,"wires":[]},{"id":"931c1691.01b86","type":"inject","z":"f898b011.8cb44","name":"led ping","topic":"","payload":"true","payloadType":"bool","repeat":"3","crontab":"","once":false,"onceDelay":0.1,"x":620,"y":60,"wires":[["d9eb827b.deffc8"]]},{"id":"d9eb827b.deffc8","type":"trigger","z":"f898b011.8cb44","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"50","extend":false,"units":"ms","reset":"","bytopic":"all","name":"","x":790,"y":60,"wires":[["163d489e.a4a277"]]},{"id":"5205ec1e.7b9b04","type":"String","z":"f898b011.8cb44","name":"oled","display":"1ac48f17.a5a1a1","x":630,"y":220,"wires":[]},{"id":"b7822373.5de7c","type":"inject","z":"f898b011.8cb44","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"60","crontab":"","once":true,"onceDelay":"5","x":130,"y":180,"wires":[["27c20c7d.b71ab4","8a04feec.274b08","103a6aa8.9b1d85","dc346a29.d5faf8"]]},{"id":"56baad6f.42d824","type":"function","z":"f898b011.8cb44","name":"up","func":"msg.payload = {\"size\":2,\"x\":1,\"y\":1,\"text\": global.get(\"up\")}\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":180,"wires":[["5205ec1e.7b9b04"]]},{"id":"27c20c7d.b71ab4","type":"Clear","z":"f898b011.8cb44","name":"clear","display":"1ac48f17.a5a1a1","x":290,"y":120,"wires":[]},{"id":"8a04feec.274b08","type":"delay","z":"f898b011.8cb44","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":300,"y":180,"wires":[["56baad6f.42d824"]]},{"id":"420e2c42.c78df4","type":"function","z":"f898b011.8cb44","name":"load","func":"var load = Number(global.get(\"load\")).toFixed(2);\n// var load = global.get(\"load\");\nmsg.payload = {\"size\":2,\"x\":1,\"y\":20,\"text\": load}\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":220,"wires":[["5205ec1e.7b9b04"]]},{"id":"103a6aa8.9b1d85","type":"delay","z":"f898b011.8cb44","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":300,"y":220,"wires":[["420e2c42.c78df4"]]},{"id":"2e3ba46c.0fe9dc","type":"function","z":"f898b011.8cb44","name":"load","func":"var temp = Number(global.get(\"temperature\")).toFixed(2);\nmsg.payload = {\"size\":2,\"x\":1,\"y\":40,\"text\": temp}\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":260,"wires":[["5205ec1e.7b9b04"]]},{"id":"dc346a29.d5faf8","type":"delay","z":"f898b011.8cb44","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":300,"y":260,"wires":[["2e3ba46c.0fe9dc"]]},{"id":"f27cfa58.1c4c78","type":"FillRectangle","z":"f898b011.8cb44","name":"rec","display":"1ac48f17.a5a1a1","x":630,"y":360,"wires":[]},{"id":"7bfc8649.e0442","type":"function","z":"f898b011.8cb44","name":"","func":"msg.payload = {x:110,y:1,w:14,h:14,color:1};\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":360,"wires":[["f27cfa58.1c4c78"]]},{"id":"6d5fdd1f.4c8bac","type":"inject","z":"f898b011.8cb44","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":360,"wires":[["7bfc8649.e0442"]]},{"id":"f8c30f07.46c47","type":"mqtt out","z":"f7a0cac1.5f5af","name":"aws iot","topic":"plant","qos":"","retain":"","broker":"fd70a59a.423ef8","x":800,"y":540,"wires":[]},{"id":"f20c7c9e.e55f4","type":"function","z":"f7a0cac1.5f5af","name":"uptime2payload","func":"msg.payload = msg.payload.uptime;\nreturn msg","outputs":1,"noerr":0,"x":420,"y":240,"wires":[["26c0a509.9f8942"]]},{"id":"2b33a2fe.1da2de","type":"mqtt in","z":"f7a0cac1.5f5af","name":"test","topic":"plant/test","qos":"0","datatype":"auto","broker":"fd70a59a.423ef8","x":240,"y":680,"wires":[["bcd6ac4a.cc2cf"]]},{"id":"bcd6ac4a.cc2cf","type":"debug","z":"f7a0cac1.5f5af","name":"aws sub","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":460,"y":680,"wires":[]},{"id":"2f5c2a88.e939f6","type":"change","z":"f7a0cac1.5f5af","name":"","rules":[{"t":"set","p":"up","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":300,"wires":[["9041c4e9.f53fe8"]]}]